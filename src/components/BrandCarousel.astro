---
import Container from "./Container.astro";
// Import ไฟล์ SVG ทั้งหมด
import img1 from "../img/brand/calvinKlein.svg";
import img2 from "../img/brand/gucci.svg";
import img3 from "../img/brand/prada.svg";
import img4 from "../img/brand/versace.svg";
import img5 from "../img/brand/zara.svg";

// สร้าง Array ของโลโก้ (ดึงเฉพาะ Object ที่ถูก Import เข้ามา)
const logos = [
  { src: img1.src, alt: "Calvin Klein Logo" },
  { src: img2.src, alt: "Gucci Logo" },
  { src: img3.src, alt: "Prada Logo" },
  { src: img4.src, alt: "Versace Logo" },
  { src: img5.src, alt: "Zara Logo" },
];
---

<div
  class="brand-carousel bg-[var(--my-color-accent)] flex overflow-hidden py-6 relative lg:overflow-visible
            
             /*class ที่ใช้ร่วมกัน*/
            [&::before,&::after]:content-['']
            [&::before,&::after]:absolute
            [&::before,&::after]:w-15
            [&::before,&::after]:h-full
           
            /*class before*/
            before:top-0 before:left-0 /* 3. จัดตำแหน่งไปที่มุมซ้ายบน */
            before:bg-[linear-gradient(to_left,rgba(255,255,255,0),#828282)] /* 6. กำหนดสีพื้นหลัง (ใส่ /50 เพื่อให้โปร่งแสง) */
        
           /*class after*/
            after:top-0 after:right-0 /* 3. จัดตำแหน่งไปที่มุมซ้ายบน */
            after:bg-[linear-gradient(to_right,rgba(255,255,255,0),#828282)] /* 6. กำหนดสีพื้นหลัง (ใส่ /50 เพื่อให้โปร่งแสง) */
           
           /*class ที่ใช้ร่วมกันเมื่อ ขนาดจอ lg*/
           [&::before,&::after]:lg:hidden"
>
  <Container class="flex">
    <div
      class="brands-slide flex w-max flex-shrink-0 lg:w-full lg:justify-between"
    >
      {
        logos.map((logo) => (
          <img
            class="mx-6 h-6 md:h-8 lg:h-8 lg:mx-0 "
            src={logo.src}
            alt={logo.alt}
          />
        ))
      }
    </div>
  </Container>
</div>

<style>
  .brands-slide {
    /* animation: slide 8s linear infinite;*/
    animation: slide 5s linear infinite;
  }
  .brand-carousel:hover .brands-slide {
    animation-play-state: paused;
  }
  @media (min-width: 1023px) {
    .brands-slide {
      animation: none;
      transform: none;
    }
  }
  @keyframes slide {
    from {
      transform: translateX(0);
    }
    to {
      transform: translateX(-100%);
    }
  }
</style>
<script>
  // JS Code: โคลน brands-slide แล้ว append เข้า brand-carousel
  document.addEventListener("DOMContentLoaded", () => {
    
    const isLargeScreen = window.matchMedia("(min-width: 1024px)").matches;  // *** ตรวจสอบ Media Query สำหรับขนาด 'lg' (min-width: 1024px) ถ้าขนาดจอเกินจะไม่ทํางาน ***
    const BrandsSlide = document.querySelector(".brands-slide");  // เลือก Element ที่มีคลาส 'brands-slide'


    if (BrandsSlide) { 
      // *** เพิ่มเงื่อนไข: โคลนเฉพาะถ้า 'isLargeScreen' เป็น FALSE เท่านั้น ***
      if (!isLargeScreen) {
        const CloneSlide = BrandsSlide.cloneNode(true); // *** แก้ไข: ตรวจสอบว่า parentNode ไม่เป็น null ก่อนเรียก appendChild ***
        const parent = BrandsSlide.parentNode; // เลือกตําเเหน่งที่จะ append โคลนเข้าไป
        if (parent) { // ตรวจสอบว่า parentNode ไม่เป็น null
          parent.appendChild(CloneSlide); // Append โคลนเข้าไปใน Container
        }

        // (ในโครงสร้างของคุณ: BrandsSlide.parentNode คือ Container Component)
      } // ถ้าเป็นจอใหญ่ (isLargeScreen เป็น true) โค้ดจะไม่ทำงาน
    }
  });
</script>

